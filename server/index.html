<html>
  <head>
    <title>WebSockets</title>
  </head>
  <body>

    <div>
      Type:
      <input type="text" id="typefield"/>
      <br />
      Data:
      <input type="text" id="datafield"/>
      <br />
      Key:
      <input type="text" id="keyfield"/>
      <br />
      <button type="button" id="send">Send</button>
    </div>
    <div id="container"></div>

    <script type="text/javascript">
      const container = document.querySelector('#container')
      if (!window.WebSocket) {
        container.innerHTML += 'Your browser does not support WebSockets'
      } else {
        const socket = new WebSocket('ws://localhost:3004')
        socket.onopen = () => container.innerHTML += '<p>Socket is open</p>'
        socket.onmessage = ({ data }) => container.innerHTML += '<p> response:' + data + '</p>'
        socket.onclose = () => container.innerHTML += '<p>Socket closed</p>'

        document.querySelector('#send').addEventListener('click', e => {
          socket.send(JSON.stringify({
            Data: document.querySelector('#datafield').value,
            Type: document.querySelector('#typefield').value,
            Key: document.querySelector('#keyfield').value
          }))
        })
      }
    </script>
  </body>
</html>
